# Global Export Settings
[common]
export_filter = "all_resources"
encrypt_pck = false
custom_features = ""
ssh_remote_deploy/enabled = false
ssh_remote_deploy/host = "user@host_ip"
ssh_remote_deploy/port = "22"

[preset.0]
name = "Linux/X11 (x86_64)"
platform = "Linux/X11"
export_path = "./builds/linux/game.x86_64"

[preset.0.options]
binary_format/architecture = "x86_64"
texture_format/bptc = true  # BC7 for modern GPUs
texture_format/s3tc = true  # DXT5 fallback
debug/export_console_wrapper = 1

# Remote Deployment Scripts
[preset.0.options.ssh_remote_deploy]
run_script = """#!/usr/bin/env bash
mkdir -p "{temp_dir}" && unzip -q "{temp_dir}/{archive_name}" -d "{temp_dir}"
nohup "{temp_dir}/{exe_name}" {cmd_args} >/dev/null 2>&1 &"""

cleanup_script = """#!/usr/bin/env bash
kill $(pgrep -f "{temp_dir}/{exe_name}")
rm -rf "{temp_dir}" """

[preset.1]
name = "Windows (x86_64)"
platform = "Windows Desktop" 
export_path = "./builds/win/game.exe"

[preset.1.options]
binary_format/architecture = "x86_64"
texture_format/bptc = true
application/file_version = "1.0.0.0"
application/product_version = "1.0"
application/company_name = "Your Studio"
application/product_name = "Game Title"
application/icon = "res://assets/icons/app_icon.ico"

[preset.1.options.codesign]
enable = true
timestamp_server_url = "http://timestamp.digicert.com"
digest_algorithm = "sha256"

[preset.1.options.ssh_remote_deploy]
run_script = """<# :Batch
@echo off
powershell -noprofile -ex bypass "iex (gc \"%~f0\" | out-string)"
exit /b
#>
Expand-Archive "{temp_dir}/{archive_name}" -Dest "{temp_dir}"
Start-Process "{temp_dir}/{exe_name}" -ArgumentList "{cmd_args}" """

cleanup_script = """<# 
Stop-Process -Name "{exe_name}" -ErrorAction SilentlyContinue
Remove-Item -Recurse -Force "{temp_dir}" """

[preset.2]
name = "Web (HTML5)"
platform = "Web"
export_path = "./builds/web/index.html"

[preset.2.options]
html/canvas_resize_policy = 2  # Responsive
html/head_include = """<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="manifest" href="site.webmanifest">"""

[preset.2.options.progressive_web_app]
enabled = true
offline_page = "res://src/web/offline.html"
background_color = Color(0.1, 0.1, 0.1, 1)
icon_512x512 = "res://assets/icons/pwa-512x512.png"

[preset.3]
name = "macOS (Universal)"
platform = "macOS"
export_path = "./builds/mac/game.app"

[preset.3.options]
binary_format/architecture = "universal"
application/bundle_identifier = "com.yourstudio.game"
application/app_category = "Games"
application/min_macos_version = "12.0"  # Monterey+

[preset.3.options.codesign]
apple_team_id = "ABCD1234XYZ"
entitlements/allow_jit_code_execution = true
entitlements/app_sandbox/enabled = true

[preset.3.options.privacy]
microphone_usage_description = "Required for voice chat features"
camera_usage_description = "Needed for avatar customization"
photos_library_usage_description = "Used for screenshot sharing"

[preset.3.options.ssh_remote_deploy]
run_script = """#!/usr/bin/env bash
unzip -q "{temp_dir}/{archive_name}" -d "{temp_dir}"
open -W "{temp_dir}/game.app" --args {cmd_args}"""

cleanup_script = """#!/usr/bin/env bash
pkill -f "game.app/Contents/MacOS/game"
rm -rf "{temp_dir}" """
